<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Introduction to R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Macroecology</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Course schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    R practicals
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="1_Intro.html">1. Introduction to R</a>
    </li>
    <li>
      <a href="2_SpatialData.html">2. Spatial data in R</a>
    </li>
    <li>
      <a href="3_RichnessGradients.html">3. Species richness gradients</a>
    </li>
    <li>
      <a href="4_SpeciesData.html">4. Global species data</a>
    </li>
    <li>
      <a href="5_SpeciesThreats.html">5. Species threats</a>
    </li>
    <li>
      <a href="6_BiodivChanges.html">6. Analysing biodiversity changes</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="mailto:damaris@zurell.de">
    <span class="fa fa-envelope"></span>
     
  </a>
</li>
<li>
  <a href="https://damariszurell.github.io">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/ZurellLab">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Introduction to R</h1>

</div>


<hr />
<div id="getting-started-in-r" class="section level1">
<h1><span class="header-section-number">1</span> Getting started in R</h1>
<p>This tutorial provides a very brief recap of R basics. The materials are prerequisite for the remainder of the course. I highly recommend looking also at other tutorial, for example:</p>
<ul>
<li>Tutorial by <a href="http://adamwilson.us/SpatialDataScience/02_graphics.html">Adam Wilson</a></li>
<li><a href="https://datacarpentry.org/R-ecology-lesson/04-visualization-ggplot2.html">Data carpentry</a></li>
<li>Introduction by <a href="https://cran.r-project.org/doc/contrib/Torfs+Brauer-Short-R-Intro.pdf">Paul Torfs and Claudia Brauer</a></li>
<li>R for Beginners by <a href="https://rbasicsworkshop.weebly.com/uploads/1/8/6/0/18603232/paradis_2005_r-forbeginners.pdf">Emmanuel Paradis</a></li>
<li>Books <a href="http://r4ds.had.co.nz/">R for Data Science</a>, or <span class="citation">Crawley (2007)</span>)</li>
</ul>
<p>The RStudio <a href="https://www.rstudio.com/resources/cheatsheets/">cheat sheets</a> are also very helpful!</p>
<p><strong>What is R?</strong></p>
<ul>
<li>a very flexible, open source programming environment for (statistical) data analyses and visualisation (www.r-project.org)<br />
</li>
<li>an object oriented and interpreted programming language based on the S language<br />
</li>
<li>runs on all common operating systems</li>
</ul>
<p><strong>How to operate R:</strong></p>
<ul>
<li>R is operated from the command line<br />
</li>
<li>work with script files for easier tractability, recycling and modification of commands</li>
<li>scripts also allow you to send big chunks of code or the entire script to the R console<br />
</li>
<li>scripts are the first step for automatizing your data manipulation and analyses</li>
<li>R has a built-in editor, but many people nowadays use R Studio (<a href="http://rstudio.org/" class="uri">http://rstudio.org/</a>) or other text editors</li>
</ul>
<div id="create-a-new-project-in-rstudio" class="section level2">
<h2><span class="header-section-number">1.1</span> Create a new project in RStudio</h2>
<p>I recommend using RStudio throughout the course. If you have not already done so, please visit the RStudio website (<a href="http://rstudio.org/" class="uri">http://rstudio.org/</a>) and download and install RStudio for your operating system.</p>
<p>I also recommend setting up an RStudio project for the entire course (UP students can watch video tutorial in Moodle) and within the RStudio project separate R scripts for each session. To do so:</p>
<ul>
<li>Open RStudio</li>
<li>Go to the tab “File” and select “New Project”</li>
<li>Select either “New Directory” if you haven’t set up a course folder yet, or select “Existing Directory” to point towards an existing folder. This directory will be the working folder for the course. Navigate to the path of the project folder on your machine (e.g. ’~Documents/Courses/Macroecology)</li>
<li>Name your project<br />
</li>
<li>Use your file explorer on your machine, find your project folder, and create four sub-folders: data, scripts, results, and figures</li>
<li>Create a new empty R script by going to the tab “File”, select “New File” and then “R script”</li>
<li>In the new R script, type <code># Session 1: R introduction</code> and save the file in your folder “scripts” within your project folder, e.g. as “1_RIntro.R”</li>
</ul>
</div>
<div id="console-and-prompt" class="section level2">
<h2><span class="header-section-number">1.2</span> Console and prompt</h2>
<p>In the R console you will find the symbol <code>&gt;</code>:</p>
<pre class="r"><code>&gt;</code></pre>
<p>This is the so-called <em>prompt</em>, which asks you for the next command.</p>
<p>The most basic thing you can do now is typing some mathematical calculations. If you see a <code>+</code> instead, then the former command is not completed yet, and R waits for further arguments (maybe you have forgotten the closing bracket?).</p>
<pre class="r"><code>20 * (5 - 3
)</code></pre>
<p>A line break or a semicolon (;) separates commands.</p>
<pre class="r"><code>2 + 3; 2 + 4</code></pre>
<p>Anything following a hashmark <code>#</code>, will be interpreted as comment and will, thus, not be executed.</p>
<pre class="r"><code>1 + 3
# 1 + 3</code></pre>
<p>You could type all code examples that are listed here, directly into your R console. You can access them by the cursor keys. However, I highly recommend storing everything into a script file.</p>
</div>
<div id="grammar-functions-and-arguments" class="section level2">
<h2><span class="header-section-number">1.3</span> Grammar: functions and arguments</h2>
<p>R comes with a huge list of commands, which we call function. In order to execute a function, it needs to be followed by brackets <code>()</code>.</p>
<pre class="r"><code>sum()</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code>sum(1,3)</code></pre>
<pre><code>## [1] 4</code></pre>
<p>Within the brackets, we can provide additional arguments to the function. Some functions always expect additional arguments, and some functions don’t. In the above example, <code>sum()</code> also works without additional arguments. The function’s default assumes that we have provided a zero vector and thus the output is a <code>0</code>. If we provide a vector of numeric values, the function will return the sum of these values.</p>
<p>Some functions have named arguments, for example the function <code>rep()</code>, which creates a vector of replicates.</p>
<pre class="r"><code>rep(x=2,times=10)</code></pre>
<pre><code>##  [1] 2 2 2 2 2 2 2 2 2 2</code></pre>
<pre class="r"><code>rep(2,10)</code></pre>
<pre><code>##  [1] 2 2 2 2 2 2 2 2 2 2</code></pre>
<p>In this example, both expression give the same results because we provided the arguments in the same order as the function expects. With named arguments, we can also change the order.</p>
<pre class="r"><code>rep(times=10,x=2)</code></pre>
<pre><code>##  [1] 2 2 2 2 2 2 2 2 2 2</code></pre>
<pre class="r"><code>rep(10,2)</code></pre>
<pre><code>## [1] 10 10</code></pre>
</div>
<div id="working-directory" class="section level2">
<h2><span class="header-section-number">1.4</span> Working directory</h2>
<p>R is always pointed at a specific directory on your computer, the working directory. You can check the current working directory by typing:</p>
<pre class="r"><code>getwd()</code></pre>
<p>If you set up the RStudio project correctly, then <code>getwd()</code> should show your course folder as working directory. Else, you change the working directory using <code>setwd()</code>. Check out the help page:</p>
<pre class="r"><code>?setwd</code></pre>
<p>See the files contained in your folder:</p>
<pre class="r"><code>dir()</code></pre>
</div>
<div id="workspace" class="section level2">
<h2><span class="header-section-number">1.5</span> Workspace</h2>
<p>You can list all objects in your workspace by typing <code>ls()</code>.</p>
<pre class="r"><code>ls()</code></pre>
<p>Probably your workspace does not list any objects yet. We can remove objects from the workspace using <code>rm()</code>.</p>
<pre class="r"><code>x &lt;- 20
y &lt;- 30
z &lt;- 40

ls()

rm(x) # removes one or more objects

rm(list=ls()) #removes all objects from workspace</code></pre>
</div>
<div id="load-and-install-packages" class="section level2">
<h2><span class="header-section-number">1.6</span> Load and install packages</h2>
<p>There are thousands of additional packages available for R. You can see the list of installed packages by typing: <code>library()</code></p>
<p>The same command is used for loading a specific package into the workspace = make it available for this session:</p>
<pre class="r"><code># loads the package raster:
library(ggplot2)
# removes package from current workspace:
detach(package:ggplot2)</code></pre>
<p>If you don’t have the packages above, install them in the package manager or by running the command</p>
<pre class="r"><code>install.packages(&quot;ggplot2&quot;, dependencies=T)</code></pre>
</div>
<div id="getting-help" class="section level2">
<h2><span class="header-section-number">1.7</span> Getting help</h2>
<p>R comes with an extensive, built-in help system, and several manuals, help pages for every available function and many additional documents.</p>
<p>You can access the built-in manuals by typing:</p>
<pre class="r"><code>help.start()</code></pre>
<p>Help pages for specific functions can be accessed with help() or with abbreviation ?.</p>
<pre class="r"><code># help page for arithmetic mean:
help(mean)
# the same:
?mean</code></pre>
<p>Most functions come with examples:</p>
<pre class="r"><code>example(mean)</code></pre>
<p>Some function calls need to be surrounded by quotation marks when calling help, e.g. special characters or expression with syntactic meaning such as if, for und function.</p>
<pre class="r"><code>?&quot;*&quot;
?&quot;if&quot;</code></pre>
<p>If you have forgotten the exact name of a function, you can search all function names, titles and keywords by typing:</p>
<pre class="r"><code>help.search(&quot;mean&quot;)
# the same:
??mean</code></pre>
<p>Search through all (installed) functions that contain the word in their function call:</p>
<pre class="r"><code>apropos(&quot;mean&quot;)</code></pre>
<p>Look at all functions contained in any package by typing:</p>
<pre class="r"><code>library (help = base)</code></pre>
<p>Some package authors offer additional documents or tutorials called vignettes:</p>
<pre class="r"><code># list all available vignettes of the installed(!) packages:
vignette()

# opens the vignette as pdf or html:
vignette(&quot;ggplot2-specs&quot;)</code></pre>
<p>Upon opening a new R session, some useful information will be printed to the console, mainly on version number and copyright. You can also extract this and other useful information by typing commands, e.g.</p>
<pre class="r"><code>sessionInfo()
citation()</code></pre>
<p>The last command is important for citing the correct packages in your theses or any other publication.</p>
</div>
</div>
<div id="operators-and-objects" class="section level1">
<h1><span class="header-section-number">2</span> Operators and Objects</h1>
<div id="operators" class="section level2">
<h2><span class="header-section-number">2.1</span> Operators</h2>
<p>You can use R as simple calculator. Simply type in the expressions; they will be executed immediately.</p>
<pre class="r"><code>1+2*3
(1+2) * 3
2 * 5 - prod (2,5)
sqrt(25^2)
sin(pi/2)
0/0</code></pre>
<p>Check out <code>?Syntax</code> to learn about the precedence of operators. If in doubt (or simply for better overview) use round brackets.</p>
<p>Useful arithmetic operators:</p>
<ul>
<li><code>^</code> or <code>**</code>: power</li>
<li><code>*</code> / <code>/</code> : multiplication / division</li>
<li><code>+</code> / <code>-</code> : addition / subtraction</li>
<li><code>%/%</code> / <code>%%</code> : integer division / modulo</li>
</ul>
<p>Useful mathematical functions:</p>
<ul>
<li><code>max()</code>, <code>min()</code>, <code>range()</code> : extreme values</li>
<li><code>abs()</code> : absolute values</li>
<li><code>sqrt()</code> : square root</li>
<li><code>round()</code>, <code>floor()</code>, <code>ceiling()</code> : round</li>
<li><code>sum()</code>, <code>prod()</code> : sum, product</li>
<li><code>log()</code>, <code>log10()</code>, <code>log2()</code> : logarithm</li>
<li><code>exp()</code> : exponential function</li>
<li><code>sin()</code>, <code>cos()</code>, <code>tan()</code>, <code>asin()</code>, <code>acos()</code>, <code>atan()</code> : trigonometric functions</li>
</ul>
<p>Numeric constants:</p>
<ul>
<li><code>pi</code> : the number <span class="math inline">\(\pi\)</span></li>
<li><code>Inf</code>, <code>-Inf</code> : infinity</li>
<li><code>NaN</code> : not defined (<em>not a number</em>)</li>
<li><code>NA</code> : Missing value (<em>not available</em>)</li>
<li><code>NULL</code> : empty value</li>
</ul>
</div>
<div id="variablesobjects" class="section level2">
<h2><span class="header-section-number">2.2</span> Variables/Objects</h2>
<p>In principle, all data structures and functions are objects in R. You can get a list with all objects contained in the current workspace by typing:</p>
<pre class="r"><code>ls()</code></pre>
<p>We can assign own objects using the assignment operator/arrow <code>&lt;-</code>.</p>
<pre class="r"><code>x &lt;- seq(1,5)</code></pre>
<p>The results of any operation assigned to an object are usually not printed in the console. If you want to see the results in real time, simply enclose the entire command in brackets:</p>
<pre class="r"><code>(x &lt;- seq(1,5))</code></pre>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<p>R is case sensitive. X is not the same as x.</p>
<pre class="r"><code>X=1
ls()</code></pre>
<p><em><strong>Naming variables/objects:</strong></em></p>
<p>There is no single naming convention in R. Even in the same package, multiple conventions might be used <em>simultaneously</em>. But usually, it’s advisable to stay consistent. Basically, thera are <a href="https://www.r-bloggers.com/consistent-naming-conventions-in-r/">five naming conventions</a> to chose from:</p>
<ul>
<li>alllowercase: <em>e.g.</em> <code>adjustcolor</code></li>
<li>period.separated: <em>e.g.</em> <code>plot.new</code></li>
<li>underscore_separated: <em>e.g.</em> <code>numeric_version</code></li>
<li>lowerCamelCase: <em>e.g.</em> <code>addTaskCallback</code></li>
<li>UpperCamelCase: <em>e.g.</em> <code>SignatureMethod</code></li>
</ul>
<p>Despite this freedom of choice, there are also some rules. Object names have to begin with a letter and may not contain any special characters except dots (.) and underscores (_). Also be careful not to use names of built-in functions and constants (nothing bad will happen, it may just create confusion), <em>e.g.</em> <code>c()</code>, <code>t()</code>, <code>F</code>, <code>TRUE</code>, <code>pi</code>. Reserved words can be found here:</p>
<pre class="r"><code>?Reserved</code></pre>
</div>
<div id="logic" class="section level2">
<h2><span class="header-section-number">2.3</span> Logic</h2>
<p>Relational and logical operators are mainly relevant for complex data requests or manipulations, and for programming, e.g. in control flows.</p>
<p>Relations:</p>
<pre class="r"><code>?Comparison
4 &lt; 3
(1 + 3)!=3</code></pre>
<p>Logical constants and operations:</p>
<pre class="r"><code>?Logic
FALSE &amp;&amp; TRUE
TRUE || FALSE
FALSE || FALSE
(3 &lt; 2) &amp;&amp; (4 == (2^2))</code></pre>
<p>Examples help understanding the difference between the operators <code>&amp;&amp;</code> resp. <code>||</code> and <code>&amp;</code> resp. <code>|</code>. The shorter form performs elementwise comparisons in much the same way as arithmetic operators. The longer form evaluates left to right examining only the first element of each vector. Evaluation proceeds only until the result is determined. The longer form is appropriate for programming control-flow and typically preferred in if-clauses.</p>
<pre class="r"><code>c(TRUE,TRUE) # c() means &#39;concatenate&#39; and combines arguments into a vector
c(TRUE,TRUE) &amp; c(FALSE, TRUE)
c(TRUE,TRUE) &amp; c(TRUE,FALSE)
c(TRUE,TRUE) &amp;&amp; c(TRUE,FALSE) # only first elements compared
c(TRUE,TRUE) &amp;&amp; c(FALSE,TRUE)</code></pre>
<p>Internally, <code>TRUE</code> is coded as 1 and <code>FALSE</code> as 0. Hence, you can also calculate with logical values. You will learn to appreciate it when doing data manipulations later on.</p>
<pre class="r"><code>x &lt;- c(3,5,1,-4,0,-2,4) # creates vector x
x &lt; 0 # which element of x is smaller than 0?
sum(x &lt; 0) # How many elements of x are smaller than 0?</code></pre>
<p>Relational operators:</p>
<ul>
<li><code>==</code>, <code>!=</code> : equal, unequal</li>
<li><code>&gt;</code>, <code>&gt;=</code> : greater than, greater or equal</li>
<li><code>&lt;</code>, <code>&lt;=</code> : smaller than, smaller or equal</li>
<li><code>!</code> : negation</li>
</ul>
</div>
<div id="basic-data-types" class="section level2">
<h2><span class="header-section-number">2.4</span> Basic data types</h2>
<p>R distinguishes five basic (atomic) data types:</p>
<p><em>Character:</em></p>
<pre class="r"><code>(first_name &lt;- &quot;Damaris&quot;)</code></pre>
<p><em>Integer:</em></p>
<pre class="r"><code>(shoe_size &lt;- 41)</code></pre>
<p><em>Numeric:</em></p>
<pre class="r"><code>(seminar_hours &lt;- 1.5)</code></pre>
<p><em>Factor:</em></p>
<pre class="r"><code>(lunch_today &lt;- factor(&#39;mensa&#39;,levels=c(&#39;mensa&#39;,&#39;bakery&#39;,&#39;chinese&#39;)))</code></pre>
<p><em>Boolean:</em></p>
<pre class="r"><code>(married &lt;- TRUE)</code></pre>
</div>
<div id="missing-values-na" class="section level2">
<h2><span class="header-section-number">2.5</span> Missing values NA</h2>
<p><code>NA</code> (Not Available) indicates missing values. For example, imagine a dataset with daily weather measurements over a longer period of time. On one day, the batteries of the weather station were empty and no measurements were taken. For integrity reasons, this empty day will still be stored in the data set but will be assigned the missing value ‘NA’. Knowing about NAs in your data is important because per default all functions will return NA if your data include NA.</p>
<pre class="r"><code>mean(c(1,5,2,NA,10,4,NA,7))</code></pre>
<p>Fortunately, you can exclude NAs from most operations.</p>
<pre class="r"><code>mean(c(1,5,2,NA,10,4,NA,7),na.rm=T)</code></pre>
<p>You can test for NAs with <code>is.na()</code></p>
<pre class="r"><code>is.na(c(1,5,2,NA,10,4,NA,7))</code></pre>
</div>
<div id="data-structures-and-object-types" class="section level2">
<h2><span class="header-section-number">2.6</span> Data structures and object types</h2>
<p>R distinguishes several objects types that differ in complexity of data structure: scalars and vectors, matrices, arrays, data frame and list. Vectors, matrices and arrays can only contain a single data type. Data frames can contain different data types in separate columns but all columns need to have the same length. Lists can contain different object types and data types.</p>
<p><img src="figures/Object_types.png" width="45%" /></p>
<p><em><strong>Vectors:</strong></em></p>
<p>There are many different ways to generate vectors in R. We have already learned concatenating <code>c()</code>.</p>
<p><em>Sequences:</em></p>
<pre class="r"><code>1:5
5:1
seq(5,10,by=0.5)  # create a sequence between 5 and 10 with an interval of 0.5
seq(5,10,length=21) # create a sequence between 5 and 10 with total length of 21
seq_len(5)  # create a sequence of integers between 1 and 5</code></pre>
<p><em>Replicates:</em></p>
<pre class="r"><code>rep(x=2,times=10) 
rep(2,10)
rep(c(1,6,5),2) # replicate the vector (1,6,5) twice
rep(c(1,6,5),each=2)  # replicate each element of the vector (1,6,5) twice</code></pre>
<p><em><strong>Matrices:</strong></em></p>
<pre class="r"><code>(x_mat &lt;- matrix(data=1:4, nrow=2)) # create a matrix with the numbers (1,2,3,4) ordered in two rows. The function automatically fills up the columns first.
(x_mat &lt;- matrix(1:4,2))  # same
x_mat[2,1]
matrix(1:4,2,byrow=T) # create a matrix with the numbers (1,2,3,4) ordered in two rows but fills up the rows first.</code></pre>
<p><em><strong>Array:</strong></em></p>
<pre class="r"><code>(x_arr &lt;- array(1:24,c(4,3,2)) # create a three-dimensional array with with four indices in first dimension, three indices in second dimension, and 2 indices in third dimension
 )
x_arr[3,2,2]</code></pre>
<p><em><strong>Data frame:</strong></em></p>
<pre class="r"><code>(veggy_shopping &lt;- data.frame(grams=c(500,1000,1000,300,200),
    veggy=c(&#39;salad&#39;,&#39;courgette&#39;,&#39;aubergine&#39;,&#39;onions&#39;,&#39;beetroot&#39;),stringsAsFactors = F))
veggy_shopping[1,]</code></pre>
<p>In data frames (and lists) we can access columns using the <code>$</code>-operator.</p>
<pre class="r"><code>veggy_shopping$veggy</code></pre>
<p><em><strong>Lists:</strong></em></p>
<pre class="r"><code>(shopping &lt;- list(post = &quot;stamps&quot;,
    farmers_market = veggy_shopping,
    bank = 60,
    bakery = c(&#39;whole grain buns&#39;,&#39;rye bread&#39;)))
shopping[1]
shopping[[1]]
shopping[&#39;bakery&#39;]
shopping[[&#39;farmers_market&#39;]]$veggy</code></pre>
</div>
<div id="indexing" class="section level2">
<h2><span class="header-section-number">2.7</span> Indexing</h2>
<p>Each element of an object type is internally assigned an index (positive integer ‘address’) and you can retrieve single elements or a subset of the object by addressing these indices. Square brackets are used for indexing.</p>
<pre class="r"><code>x[3] # retrieve the 3rd element of vector x
x[3:4] # use can also address sequences</code></pre>
<p>Basically, we distinguish four kinds of index vector: logical, positive integer, negative integer for excluding elements (inverse indexing), and character indices if we have named vectors.</p>
<pre class="r"><code>(x2 &lt;- c(x,NA))
x2[!is.na(x2)] # logical index vector
x2[c(1,3:4)] # index vector with positive integers
x2[-c(1,3:4)] # index vector with negative integers
(Fruits &lt;- c(Orange=5, Banana=10, Apple=1, Pear=20))
(Grocery &lt;- Fruits[c(&quot;Orange&quot;,&quot;Apple&quot;)]) # character index</code></pre>
<p>You can also modify single elements.</p>
<pre class="r"><code>Fruits[&quot;Banana&quot;] &lt;- 0</code></pre>
</div>
<div id="object-structures" class="section level2">
<h2><span class="header-section-number">2.8</span> Object structures</h2>
<p>Use <code>str()</code> for displaying the object structure.</p>
<pre class="r"><code>str(x_mat)
str(x_arr)
str(gcib_schedule)
str(gcib_course)</code></pre>
<p>The character vector ‘fun_factor’ in <code>gcib_schedule</code> was automatically converted to factors. This is ok here, but one may want to change this behaviour for other purposes. See the help page <code>?data.frame</code> to find out how.</p>
</div>
</div>
<div id="writing-loops-and-functions" class="section level1">
<h1><span class="header-section-number">3</span> Writing loops and functions</h1>
<div id="control-flows" class="section level2">
<h2><span class="header-section-number">3.1</span> Control flows</h2>
<p>Control-flow constructs are among the most important <em>building blocks</em> in programming because they help structuring the workflow. We use loops for repeating workflows, and conditional expressions and switch statements for making choices between alternative control flows based on some conditions.</p>
<div id="if-else-ifelse" class="section level3">
<h3><span class="header-section-number">3.1.1</span> If, else, ifelse</h3>
<p>We use conditional expressions if specific computations and actions should only be performed under certain conditions. R knows three conditional expressions:</p>
<ul>
<li><code>if(condition){command block}</code></li>
<li><code>if(condition){command block} else{alternative command block}</code></li>
<li><code>ifelse(condition, command block, alternative command block)</code></li>
</ul>
<p>These functions always require a Boolean condition, meaning that it needs to evaluate to <code>TRUE</code> or <code>FALSE</code>. Single commands do not need to be surrounded by curly brackets. Still, for beginners, they facilitate overview. Conditional expressions may be nested.</p>
<pre class="r"><code>number &lt;- 12

if (number &lt; 12) {
  print(&#39;This number is smaller than 12.&#39;)
} else 
    if (number==12) {
      print(&#39;This number is equal to 12.&#39;)
    } else {
        print(&#39;This number is greater than 12.&#39;)
      }</code></pre>
<pre><code>## [1] &quot;This number is equal to 12.&quot;</code></pre>
<p>The function <code>ifelse()</code> allows elementwise evaluation of the condition.</p>
<pre class="r"><code>x &lt;- 5
ifelse (x %in% c(5,6), TRUE, FALSE)</code></pre>
<p><code>ifelse()</code> is most useful for evaluating elements of a vector according to a specific condition.</p>
<pre class="r"><code>(x&lt;-sample(1:20,30,replace=T))
ifelse(x&lt;=10,0,1)</code></pre>
</div>
</div>
<div id="for-loops" class="section level2">
<h2><span class="header-section-number">3.2</span> For-Loops</h2>
<p>You will often hear that loops should be avoided in R codes wherever possible as they tend to make your codes slower. Nevertheless, they are an important element in programming. We use them, for example, for iterating (parts of) code blocks with different parameters or initial values. R offers three different loop structures: <code>repeat</code>, <code>while</code> and <code>for</code>, where the latter is the most commonly used.</p>
<p>The <code>for</code> loop iterates through all elements of a provided vector: <code>for (i in M) {command block}</code>. See the help page <code>?&quot;for&quot;</code>.</p>
<pre class="r"><code>x &lt;- c(3,6,2,5,10)

for (i in x) {
  print(i^2)
}</code></pre>
</div>
<div id="functions" class="section level2">
<h2><span class="header-section-number">3.3</span> Functions</h2>
<p>R and the contributed packages contain a myriad of built-in functions. Still, it might be useful to write your own functions at some point. For example, you can combine a number of consecutive commands under one name/function. This facilitates recurring computations and improves clarity of your scripts.</p>
<p>Function definitions always start with <code>function()</code> followed by a command block in curly brackets <code>{}</code>. Obligatory and optional arguments are defined in the round brackets (). You can define arguments with and without default settings, and the argument list may also be emtpy.</p>
<pre class="r"><code># function without arguments:
greetings &lt;- function(){
    print(&#39;Hello world&#39;)
    }
greetings()

# function with obligatory argument without default:
greetings &lt;- function(name){
    print(paste(&#39;Hello&#39;,name))
    }
greetings(&#39;students&#39;)

#function with one obligatory argument and another argument with default
greetings &lt;- function(name,greet=&#39;Hello&#39;){
    print(paste(greet,name))
    }
greetings(&#39;students&#39;)
greetings(&#39;students&#39;,&#39;Wake up&#39;)</code></pre>
</div>
</div>
<div id="data-import-and-export" class="section level1">
<h1><span class="header-section-number">4</span> Data import and export</h1>
<p>R offers several options for accessing different data formats. Standard formats include text files (in ASCII format), binary files, R files (single objects or entire workspaces), and databases. These data can be read in from files using a file path, but also from the Internet using an URL path or from the clipboard. Of course, you can also write to these same devices. A good overview is provided in the manual „R Data Import/Export“ (R Development Core Team 20xx), which you can access by typing help.start(). The manual also contains information on some useful packages, e.g. <code>foreign</code>, which provides access to datasets created with different statistical software such as SAS, SPSS, S-PLUS etc. Data import using the package <code>tidyverse</code> is briefly explained in the <a href="https://www.rstudio.com/resources/cheatsheets/">RStudio cheat sheets</a>.</p>
<div id="write-text-data" class="section level2">
<h2><span class="header-section-number">4.1</span> Write text data</h2>
<p>All objects created in R can be exported to file. Data frame can be written to file by <code>write.table</code> and its variants:</p>
<pre class="r"><code>write.table(veggy_shopping,&quot;myData.txt&quot;, row.names=F, col.names=T, sep=&#39;,&#39;)
write.csv(veggy_shopping,&quot;myData.csv&quot;)</code></pre>
<p>Important arguments: - <code>file</code>: (path) and file name - <code>sep</code>: column separator. Default: &quot; &quot; (white space or tab) - <code>dec</code>: character used for decimal points. Default: “.”</p>
<p>The function <code>write()</code> allows writing vectors and matrices to file. However, it contains some surprising default settings. Check out the help pages and below example. For demonstration purpose, we pipe the output into the console (&quot;&quot;).</p>
<pre class="r"><code># Write vector:
write(x,&quot;&quot;)
write(1:1000,file=&quot;myColumn.txt&quot;)

# Write matrix:
(Xmat &lt;- matrix(1:10,ncol=5))
write(Xmat,&quot;&quot;)</code></pre>
<p>Surprisingly, the matrix is not exported in the right structure. Check out the help page <code>?write</code> to find out more about it.</p>
<pre class="r"><code># transpose matrix before exporting: works!
write(t(Xmat),&quot;&quot;)</code></pre>
</div>
<div id="read-text-data" class="section level2">
<h2><span class="header-section-number">4.2</span> Read text data</h2>
<p>List all files in your folder by typing:</p>
<pre class="r"><code>list.files()

# alternative that also lists folders:
dir()</code></pre>
<p>The data file <code>myData.txt</code> is in table format (data frame); every column has a name, and columns are separated by comma. This information is important for correct reading:</p>
<pre class="r"><code>my_df &lt;- read.table(&#39;myData.txt&#39;)</code></pre>
<p>There may be several reasons for an error message. Is the data table correct? Do all columns contain the same number of elements? Yes, the data file is correct. Then, it probably has to do with the arguments passed to <code>read.table()</code>. Have a look at the help page and the default settings.</p>
<p>Important arguments: - <code>file</code>: (path) and file name - <code>header</code>: logical value indicating wether file contains column names; defaults to <code>FALSE</code> - <code>sep</code>: column separator. Default: &quot; &quot; (white space or tab) - <code>dec</code>: character used for decimal points. Default: “.” - <code>colClasses</code>: optional vector giving data types for each column - <code>stringsAsFactors</code>: set to <code>FALSE</code> to avoid automatic transformation of character to factor.</p>
<p>R expects white spaces as field separator but we had separated our data columns by comma when saving the file. Also, R does not assume column names. So, we have to tell R. correct reading:</p>
<pre class="r"><code>(my_df &lt;- read.table(&#39;myData.txt&#39;, sep=&#39;,&#39;, header=T))
str(my_df)
names(my_df)
summary(my_df)</code></pre>
<p>There are also some useful modifications for common formats, e.g. for comma-separated files (csv):</p>
<pre class="r"><code>read.csv(&#39;myData.txt&#39;)
read.csv(&#39;myData.csv&#39;)</code></pre>
<p>Sometimes, using read.table() or its modifications is not meaningful. The next example file does not contain a data table but only a (very long) vector. <code>read.table()</code> will still work but it will be slow, and will create a data frame object with many rows in only one column, which is not very sensible.</p>
<pre class="r"><code>read.table(&quot;myColumn.txt&quot;)</code></pre>
<p>For such one-row or one-column data files, it is better to use functions like <code>scan()</code>. With some exercise, this command can also be used for reading very complex data structures.</p>
<pre class="r"><code>scan(&quot;myColumn.txt&quot;)</code></pre>
<p>Other packages are available that provide more convenient functions for data import, e.g. <code>tidyverse</code> or <code>data.table</code>. Often, these functions will automatically detect the data structure in the files.</p>
<pre class="r"><code>library(tidyverse)
read_delim(&quot;myData.txt&quot;)

# so, read_delim does not detect the column separator
read_delim(&quot;myData.txt&quot;,delim=&#39;,&#39;)
read_csv(&quot;myData.txt&quot;)

library(data.table)
fread(&#39;myData.txt&#39;)</code></pre>
</div>
<div id="read-and-write-r-objects" class="section level2">
<h2><span class="header-section-number">4.3</span> Read and write R objects</h2>
<p>A very useful option is to save R objects (<code>save()</code>) or the entire workspace (<code>save.image()</code>). With the latter, you can simply continue an R session at any later time. Saving single objects may be useful, for example, for saving statistical models that were estimated and analysed but that you want to keep for later references, for repeating some analyses etc.</p>
<pre class="r"><code># save object Xmat
save(Xmat,file=&quot;Xmat.Rdata&quot;)</code></pre>
<p>You can load R objects or workspaces using <code>load()</code>.</p>
<div class="alert alert-info">
<p><em><strong>Exercise:</strong></em></p>
<p>Save the entire workspace as <code>“Day1.RData”</code> and quit R (e.g. by typing <code>quit()</code> or <code>q()</code>). Open a new R session and load workspace „Day1“. All data should be available again.</p>
</div>
</div>
</div>
<div id="statistics" class="section level1">
<h1><span class="header-section-number">5</span> Statistics</h1>
<p>Statistics are at the heart of R and probably the reason why I learned this language in the first place. Here, I will just provide a brief overview of descriptive summary statistics, probability distributions, and random numbers. I don’t introduce simple linear regression here as we will do a lot of regression in the other weeks.</p>
<div id="descriptive-statistics" class="section level2">
<h2><span class="header-section-number">5.1</span> Descriptive statistics</h2>
<p>These describe data samples, for example the central tendency, spread and variance, or relationships in cases of bi- or multivariate data.</p>
<p>Important functions to know for first and second order moments are:</p>
<ul>
<li><code>mean(x)</code>, <code>weighted.mean(x)</code>, <code>median(x)</code> : arithmetic mean, weighted mean, and median of a vector (here: x)</li>
<li><code>quantile(x, probs=p)</code> : the p% quantile of vector x</li>
<li><code>sd(x)</code>, <code>var(x)</code>: standard deviation, and variance (both with denominator n-1)</li>
<li><code>mad(x)</code> : median absolute deviation</li>
<li><code>range(x)</code> : minimum and maximum values</li>
<li><code>diff(range(x))</code> : spread</li>
<li><code>diff(quantile(x,c(0.25,0.75)))</code> : interquartile range</li>
<li><code>cor(x,y)</code>, <code>cov(x,y)</code> : correlation coefficient, and covariance</li>
</ul>
</div>
<div id="probability-distribution-and-random-numbers" class="section level2">
<h2><span class="header-section-number">5.2</span> Probability distribution and random numbers</h2>
<p>R offers several built-in probabability distributions, which usually come with four functions: probability density function (prefix <code>d</code> for density), cumulative distribution function (prefix <code>p</code> for probability), a function for calculating quantiles (prefix <code>q</code> for quantiles) and a function for generating (pseudo-) random numbers (prefix <code>r</code> for random).</p>
<p>Have a look at the help pages to find all the built-in distributions: <code>?Distributions</code></p>
<p>Let’s have a look at the normal distribution. As default, R assumes the standard normal distribution with <code>mean=0</code> and <code>sd=1</code>. We first look at the probability density function.</p>
<pre class="r"><code>x &lt;- seq(-10,10,by=0.5)

curve(dnorm(x),-3,6,lwd=2,xaxs=&quot;i&quot;,yaxs=&quot;i&quot;,ylim=c(0,0.5)) #plots density function
curve(dnorm(x,mean=2),-3,6,col=&quot;red&quot;,add=T,lwd=2) 
curve(dnorm(x,mean=2,sd=2),-3,6,col=&quot;green&quot;,add=T,lwd=2)

# What is the probability of a random variable x being 0?
dnorm(0)</code></pre>
<pre><code>## [1] 0.3989423</code></pre>
<pre class="r"><code>arrows(0,0,0,dnorm(0)) 
arrows(0,dnorm(0),-3,dnorm(0))

dnorm(0,2)</code></pre>
<pre><code>## [1] 0.05399097</code></pre>
<pre class="r"><code>arrows(0,0,0,dnorm(0,2),col=&quot;red&quot;) 
arrows(0,dnorm(0,2),-3,dnorm(0,2),col=&quot;red&quot;) 

dnorm(0,2,2) </code></pre>
<pre><code>## [1] 0.1209854</code></pre>
<pre class="r"><code>arrows(0,0,0,dnorm(0,2,2),col=&quot;green&quot;) 
arrows(0,dnorm(0,2,2),-3,dnorm(0,2,2),col=&quot;green&quot;)</code></pre>
<p><img src="1_Intro_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<p>The cumulative density function:</p>
<pre class="r"><code>curve(pnorm(x),-3,6,lwd=2,xaxs=&quot;i&quot;,yaxs=&quot;i&quot;) 
curve(pnorm(x,2),-3,6,col=&quot;red&quot;,lwd=2,add=T) 
curve(pnorm(x,2,2),-3,6,col=&quot;green&quot;,lwd=2,add=T)

# What is the probability that a normally distributed random variable will be smaller than x?
pnorm(0)</code></pre>
<pre><code>## [1] 0.5</code></pre>
<pre class="r"><code>arrows(0,0,0,pnorm(0)) 
arrows(0,pnorm(0),-3,pnorm(0))

pnorm(0,2)</code></pre>
<pre><code>## [1] 0.02275013</code></pre>
<pre class="r"><code>arrows(0,0,0,pnorm(0,2),col=&quot;red&quot;) 
arrows(0,pnorm(0,2),-3,pnorm(0,2),col=&quot;red&quot;) 

pnorm(0,2,2) </code></pre>
<pre><code>## [1] 0.1586553</code></pre>
<pre class="r"><code>arrows(0,0,0,pnorm(0,2,2),col=&quot;green&quot;) 
arrows(0,pnorm(0,2,2),-3,pnorm(0,2,2),col=&quot;green&quot;)</code></pre>
<p><img src="1_Intro_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<p>The quantile function is the inverse of the cumulative distribution function. So, we ask the other way around: which value of the random variable x corresponds to probability p? For example, when we look at the 50% quantile (meaning the lower 50% of all possible values of the random variable x), what is the maximum value x may reach?</p>
<pre class="r"><code>curve(pnorm(x),-3,6,lwd=2,xaxs=&quot;i&quot;,yaxs=&quot;i&quot;)
curve(pnorm(x,2),-3,6,col=&quot;red&quot;,lwd=2,add=T) 
curve(pnorm(x,2,2),-3,6,col=&quot;green&quot;,lwd=2,add=T) 

qnorm(0.5)
arrows(-3,0.5,qnorm(0.5),0.5) 
arrows(qnorm(0.5),0.5,qnorm(0.5),0)

qnorm(0.5,2)
arrows(-3,0.5,qnorm(0.5,2),0.5,col=&quot;red&quot;) 
arrows(qnorm(0.5,2),0.5,qnorm(0.5,2),0,col=&quot;red&quot;) 

qnorm(0.5,2,2) 
arrows(-3,0.5,qnorm(0.5,2,2),0.5,col=&quot;green&quot;) 
arrows(qnorm(0.5,2,2),0.5,qnorm(0.5,2,2),0,col=&quot;green&quot;)</code></pre>
<p>Possibly the most important aspect of these probability distributions is that we can generate random numbers from them.</p>
<pre class="r"><code>par(mfrow=c(3,1)) 
hist(rnorm(1000),xlim=c(-5,10),main=&quot;&quot;) 
hist(rnorm(1000,2),xlim=c(-5,10),main=&quot;&quot;) 
hist(rnorm(1000,2,2),xlim=c(-5,10),main=&quot;&quot;)</code></pre>
</div>
<div id="draw-samples" class="section level2">
<h2><span class="header-section-number">5.3</span> Draw samples</h2>
<p>Another very useful feature is that we can draw samples from a vector using <code>sample()</code>. As arguments, it takes a scalar or vector from which to draw, and the number of samples to draw. Per default, samples are drawn without replacement.</p>
<pre class="r"><code>sample(1:30,size=20) # without replacement 
sample(30,size=20) # same 
sample(1:30,size=20,replace=T) # with replacement 
sample(letters,10)</code></pre>
</div>
<div id="statistical-tests" class="section level2">
<h2><span class="header-section-number">5.4</span> Statistical tests</h2>
<p>For the sake of completeness, I mention statistical tests here although I cannot treat them in detail and this is not a stats class <em>per se</em>. For more information, have a look at introductory statistics books with R, e.g. <span class="citation">Crawley (2007)</span>, and <span class="citation">Dormann (2013)</span> (in German but really good).</p>
<div id="one-sample-tests" class="section level3">
<h3><span class="header-section-number">5.4.1</span> One-sample tests</h3>
<p>The Shapiro-Wilk-Test tests for normality of a sample:</p>
<pre class="r"><code>shapiro.test(rnorm(100))
shapiro.test(rnorm(1000))
shapiro.test(rnorm(10))</code></pre>
<p>The <span class="math inline">\(p\)</span>-value always refers to the probability of the null hypothesis (here, ‘the sample is normally distributed’). For a sufficiently small <span class="math inline">\(p\)</span> (<span class="math inline">\(p &lt; 0.05\)</span> is wuite common), the null hypothesis gets rejected. xwIn above example, the data probably stem from a normal distribution (well, what a surprise given that we generated the data from a normal distribution). You should also see that the certainty of theses tests is strongly dependent on the sample size. Let’s compare to uniform random numbers:</p>
<pre class="r"><code>shapiro.test(runif(100))</code></pre>
<p>If data are normally distributed, we can use the t-test to compare the mean of a sample to specified value/null hypothesis. Let’s generate a normally distributed random variable and compare this to the expected value of <code>0</code>:</p>
<pre class="r"><code>t.test(rnorm(100),mu=0)
t.test(rnorm(100,2),mu=0)</code></pre>
<p>If the data are not normally distributed, the Wilcoxon signed rank test wilcox.test() provides an alternative for the t-test.</p>
</div>
<div id="two-sample-tests" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Two-Sample-Tests</h3>
<p>If you have paired samples, use the option <code>paired=TRUE</code> in the t-Test and Wilcoxon-Test. Per default, both tests are implemented for unpaired samples.</p>
<pre class="r"><code>t.test(rnorm(100),rnorm(80))      # not significantly different
t.test(rnorm(100),rnorm(80,2))    # significantly different</code></pre>
<p>If you want to test for equality of variances, use the F-Test:</p>
<pre class="r"><code>var.test(rnorm(100),rnorm(100))       # not significantly different
var.test(rnorm(100),rnorm(100,sd=2))  # significantly different</code></pre>
<p>Of course, there are many more tests available in R, for examples see <code>library(help=stats)</code>.</p>
</div>
</div>
</div>
<div id="simple-data-wrangling" class="section level1">
<h1><span class="header-section-number">6</span> Simple data wrangling</h1>
<p>R offers different options for inspecting, subsetting and manipulating data. We use the iris data that is contained in the R distribution</p>
<pre class="r"><code>data(iris)

# Inspect the first five lines
head(iris)

# Inspect the last five lines
tail(iris)

# Check data structure:
str(iris)</code></pre>
<div id="extract-data" class="section level2">
<h2><span class="header-section-number">6.1</span> Extract data</h2>
<p>We have already seen how to subset columns by indexing:</p>
<pre class="r"><code>iris[,c(&#39;Petal.Length&#39;)]
summary(iris[,c(&#39;Petal.Length&#39;)])</code></pre>
<p>Rows can also be extracted using indexing, or by using the function <code>subset()</code>. Here, we need the logical and relational operators mentioned earlier</p>
<pre class="r"><code># selecting rows using indexing
iris[iris$Species==&#39;virginica&#39;,]
iris[iris$Species==&#39;virginica&#39; &amp; iris$Sepal.Length &gt; 6.5,]

# selecting rows using subset
subset(iris, Species==&#39;virginica&#39;)
subset(iris, Species==&#39;virginica&#39; &amp; Sepal.Length &gt; 6.5)</code></pre>
</div>
<div id="join-data" class="section level2">
<h2><span class="header-section-number">6.2</span> Join data</h2>
<p>When processing data, it is often necessary to join/merge different data sets. As a simple example, we create two data frames, one with a price list for groceries and one with our shopping list.</p>
<pre class="r"><code>prices_market &lt;- data.frame(product=c(&#39;apples&#39;,&#39;tomatoes&#39;,&#39;blueberries&#39;,&#39;strawberries&#39;), price_per_kg=c(2.5, 3.5, 5.20, 4.50))
shopping_list &lt;- data.frame(product=c(&#39;apples&#39;,&#39;strawberries&#39;,&#39;bananas&#39;), amount_in_kg=c(1.5,0.5,2))</code></pre>
<p>We now use the function <code>merge()</code> for joining the two data frames. Thereby, we have the option of ignoring non-matching entries or filling these up with NAs.</p>
<pre class="r"><code># The joined data frame contains only matching entries:
merge(prices_market, shopping_list, by=&#39;product&#39;)

# NAs will be added for the non-matching entries
merge(prices_market, shopping_list, by=&#39;product&#39;, all=T)</code></pre>
</div>
<div id="family-apply" class="section level2">
<h2><span class="header-section-number">6.3</span> Family <code>apply</code></h2>
<p>If you want to do complex operations on matrices, data frames or lists, <code>apply()</code> and its derivates are most often the tool of choice as they run a lot faster than loops. This is what is often termed <em>vectorizing</em> your code.</p>
<p><code>apply()</code> allows row-wise and column-wise execution of functions over matrices, data.frames and arrays. Thereby, the argument <code>MARGIN</code> refers to the dimension you want the operation to run over (1 means row-wise, 2 column-wise). Also you have to provide an argument <code>FUN</code> that specifies which function you want to run over the array. In the following examples, we calculate the mean.</p>
<pre class="r"><code># Build a numeric matrix
(Xmat=matrix(1:12,nrow=4)) 

# Calculate the mean of all rows
apply(Xmat,1,mean) 

# Calculate the mean of all columns
apply(Xmat,2,mean) </code></pre>
<p>You can also define own <em>anonymous</em> functions in the form <code>FUN=function(x){...}</code>.</p>
<pre class="r"><code>(Xdf &lt;- data.frame(x=rep(1,10), y=rep (3,10)))

apply(Xdf,1,FUN=function(x){sum(x)^2}) </code></pre>
<p>Also check out `<code>lapply()</code> and <code>sapply()</code> that are useful functions for operations over vectors or lists.</p>
<div id="rowsums-rowmeans-etc" class="section level3">
<h3><span class="header-section-number">6.3.1</span> rowSums(), rowMeans() etc</h3>
<p>There are some convenient and fast implementations to form row and column sums and means for numeric matrices (or arrays) and data frames. They are equivalent to using the function <code>mean</code> or <code>sum</code> with <code>apply()</code> as above but probably easier to handle for you.</p>
<pre class="r"><code># Calculate the mean and sum of all rows
rowMeans(Xmat)
rowSums(Xmat)

# Calculate the mean and sum of all columns
colMeans(Xmat)
colSums(Xmat)</code></pre>
</div>
</div>
</div>
<div id="visualising-data" class="section level1">
<h1><span class="header-section-number">7</span> Visualising data</h1>
<div id="base-graphics" class="section level2">
<h2><span class="header-section-number">7.1</span> Base graphics</h2>
<p>R has many base functions for plotting graphics. So-called <em>high-level</em> graphic functions produce complete, independent graphics such as boxplots, histograms or scatterplots along with axes labels and titles. You can modify these according to your needs by optional arguments, e.g. labels, line widths, point symbols, colours.</p>
<p>Let’s first create some data for visualisation:</p>
<pre class="r"><code>height &lt;- rnorm(200,mean=180,sd=10)
pop &lt;- data.frame(height=height, weight=-60+height*0.8+rnorm(200,sd=15),
    age=rpois(200,42), sex=sample(c(&#39;F&#39;,&#39;M&#39;),200,replace=T))</code></pre>
<p>Now, make very simple scatterplots</p>
<pre class="r"><code># explicitly provide x and y axis
plot(x=pop$height, y=pop$weight)

# formula method
plot(weight~height, data=pop)</code></pre>
<p>You can customize the plot with various options. See <code>?par</code> for options.</p>
<pre class="r"><code>plot(x=pop$height, y=pop$weight, pch=19, col=&#39;salmon&#39;,
    xlab=&#39;Body height [cm]&#39;, ylab=&#39;Body weight [km]&#39;,
    main=&#39;Relationship between body size and weight&#39;)</code></pre>
<p><img src="1_Intro_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
<p>You can change the plot type using the <code>type</code> argument.</p>
<pre class="r"><code>plot(pop$height, type=&#39;l&#39;)</code></pre>
<p>Histograms and boxplots:</p>
<pre class="r"><code># open a new graphic device
# under Windows OS it should be &quot;windows()&quot;, under linux &quot;x11()&quot;
quartz(w=6,h=6)

hist(pop$height)
boxplot(pop$height~pop$sex)</code></pre>
<p>So-called <em>low-level</em> graphic functions let you add certain elements to existing plots, e.g. lines, labels, legends etc. Also, you can make mathematical annotations (<code>?plotmath</code>).</p>
<pre class="r"><code># Set the plot margin size; see &quot;?par&quot;
par(mar=c(5,4,4,4)+0.1)

plot(x=pop$height, y=pop$weight, pch=19, col=&#39;salmon&#39;,
    xlab=&#39;Body height [cm]&#39;, ylab=&#39;Body weight [km]&#39;,
    main=&#39;Relationship between body size and weight&#39;,
    ylim=c(0,max(pop$weight)))

# add regression line
abline(lm(pop$weight ~pop$height), col=&#39;salmon3&#39;, lwd=2)

# add points
points(x=pop$height, y=pop$age, pch=17, col=&#39;CornFlowerBlue&#39;)
abline(lm(pop$age ~pop$height), col=&#39;blue3&#39;, lwd=2)

# add axis for age
axis(4,at=pretty(range(pop$age)),col.axis=&#39;CornFlowerBlue&#39;)

# add axis label
mtext(&#39;Age&#39;,side=4,col=&#39;CornFlowerBlue&#39;, line=2.5)</code></pre>
<p><img src="1_Intro_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
</div>
<div id="plotting-with-ggplot2" class="section level2">
<h2><span class="header-section-number">7.2</span> Plotting with <code>ggplot2</code></h2>
<p><code>ggplot2</code> is a visualisation library that allows more elegant and versatile plotting. It follows quite a different philosophy than base graphics. Plots are built step by step. This basic template can be used for different types of plots:</p>
<p><code>ggplot(data = &lt;DATA&gt;, mapping = aes(&lt;MAPPINGS&gt;)) +  &lt;GEOM_FUNCTION&gt;()</code></p>
<pre class="r"><code>library(ggplot2)</code></pre>
<p>The ggplot() function binds the plot to a specific data frame using the data argument.</p>
<pre class="r"><code>ggplot(data = pop)      # this provides a blank ggplot object</code></pre>
<p>Using the aesthetic function <code>aes()</code> we can define the geometric and statistical objects (color, size, shape, and position).</p>
<pre class="r"><code>p &lt;- ggplot(data = pop, mapping = aes(x = height, y = weight))</code></pre>
<p>Using the <code>geom_</code> functions, we can add the geometric shapes representing the data, e.g.: - <code>geom_point()</code> for scatter plots, dot plots, etc. - <code>geom_boxplot()</code> for boxplots - <code>geom_line()</code> for trend lines, time series, etc.</p>
<pre class="r"><code>p + geom_point()

# you can also do it in one go
ggplot(data = pop, mapping = aes(x = height, y = weight)) + geom_point()</code></pre>
<p>We can modify this plot by adding colours, transparency etc.</p>
<pre class="r"><code>p + geom_point(color=&#39;salmon&#39;)

# add transparency:
p + geom_point(color=&#39;salmon&#39;, alpha=0.5)

# assign different colours to females and males:
p + geom_point(aes(color=sex))

# assign different symbols to age classes:
p + geom_point(aes(color=sex, shape=factor(round(age/10)*10)))</code></pre>
<pre class="r"><code># assign different point sizes to age:
p + geom_point(aes(color=sex, size=age))</code></pre>
<p><img src="1_Intro_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
<p>Add a linear model or Loess smoother:</p>
<pre class="r"><code># regression line:
p + geom_point() + geom_smooth(method=&quot;lm&quot;)</code></pre>
<pre class="r"><code># smoother:
p + geom_point() + geom_smooth(method=&quot;loess&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="1_Intro_files/figure-html/unnamed-chunk-100-1.png" width="672" /></p>
<p>Boxplot:</p>
<pre class="r"><code>ggplot(data = pop, mapping = aes(x = sex, y = weight)) +
    geom_boxplot()</code></pre>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-crawley2007">
<p>Crawley, Michael J. 2007. <em>The R Book</em>. UK: John Wiley &amp; Sons.</p>
</div>
<div id="ref-Dormann2013a">
<p>Dormann, Carsten F. 2013. <em>Parametrische Statistik</em>. Springer.</p>
</div>
</div>
</div>

<!DOCTYPE html>
<html>

<br>
<hr />
<div id="footer">
<p>Damaris Zurell, 2020 <a href="http://creativecommons.org/licenses/by/4.0/" >(CC BY 4.0)</a>.  </p>
</div>

</html>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
